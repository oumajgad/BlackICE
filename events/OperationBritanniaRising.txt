#################################################################################################
#
# Marneman's Operation Britannia Rising (Liberation of England) Events
#
# History reveals nothing of an "Operation Britannia Rising".  However, had the Germans actually
# invaded and conquered England, there would not have been an Operation Overlord, at least not at
# first. More than likely, the USA would have moved to liberate England first, and deal with the
# rest of Europe later.  This event series is designed to fulfull that scenario, should the
# Germans succeed in a conquest of England prior to June 6, 1944 (D-Day).
#
# -Marneman
#
#################################################################################################
#################################################################################################
#
# Initiation event
#
#################################################################################################
country_event = {
	id = 995000
	trigger = {
		# AI/USA only!
		tag = USA
		ai = yes
		# Mainland England has to be toast
		# These don't seem to work ... fucking hell!  We have to list every province manually ... :(
		#mainland_england = { controlled_by = GER }
		#mainland_england = { controller = { faction = axis  } }
		2307 = {
			controlled_by = GER
		}
		2192 = {
			controlled_by = GER
		}
		2134 = {
			controlled_by = GER
		}
		2075 = {
			controlled_by = GER
		}
		2193 = {
			controlled_by = GER
		}
		2250 = {
			controlled_by = GER
		}
		2076 = {
			controlled_by = GER
		}
		2018 = {
			controlled_by = GER
		}
		1962 = {
			controlled_by = GER
		}
		1906 = {
			controlled_by = GER
		}
		1905 = {
			controlled_by = GER
		}
		1845 = {
			controlled_by = GER
		}
		1904 = {
			controlled_by = GER
		}
		1844 = {
			controlled_by = GER
		}
		1846 = {
			controlled_by = GER
		}
		1785 = {
			controlled_by = GER
		}
		1726 = {
			controlled_by = GER
		}
		1665 = {
			controlled_by = GER
		}
		1613 = {
			controlled_by = GER
		}
		1727 = {
			controlled_by = GER
		}
		1786 = {
			controlled_by = GER
		}
		1847 = {
			controlled_by = GER
		}
		1728 = {
			controlled_by = GER
		}
		1666 = {
			controlled_by = GER
		}
		1787 = {
			controlled_by = GER
		}
		1907 = {
			controlled_by = GER
		}
		2019 = {
			controlled_by = GER
		}
		2136 = {
			controlled_by = GER
		}
		2077 = {
			controlled_by = GER
		}
		2135 = {
			controlled_by = GER
		}
		2078 = {
			controlled_by = GER
		}
		2079 = {
			controlled_by = GER
		}
		2020 = {
			controlled_by = GER
		}
		11380 = {
			controlled_by = GER
		}
		11379 = {
			controlled_by = GER
		}
		2021 = {
			controlled_by = GER
		}
		1964 = {
			controlled_by = GER
		}
		1908 = {
			controlled_by = GER
		}
		452 = {
			controlled_by = GER
		}
		1848 = {
			controlled_by = GER
		}
		1963 = {
			controlled_by = GER
		}
		7938 = {
			controlled_by = GER
		}
		1909 = {
			controlled_by = GER
		}
		1849 = {
			controlled_by = GER
		}
		1789 = {
			controlled_by = GER
		}
		1731 = {
			controlled_by = GER
		}
		1670 = {
			controlled_by = GER
		}
		1790 = {
			controlled_by = GER
		}
		1850 = {
			controlled_by = GER
		}
		1669 = {
			controlled_by = GER
		}
		1617 = {
			controlled_by = GER
		}
		1730 = {
			controlled_by = GER
		}
		1788 = {
			controlled_by = GER
		}
		1729 = {
			controlled_by = GER
		}
		1564 = {
			controlled_by = GER
		}
		1612 = {
			controlled_by = GER
		}
		1565 = {
			controlled_by = GER
		}
		1521 = {
			controlled_by = GER
		}
		1477 = {
			controlled_by = GER
		}
		1387 = {
			controlled_by = GER
		}
		1342 = {
			controlled_by = GER
		}
		1297 = {
			controlled_by = GER
		}
		1254 = {
			controlled_by = GER
		}
		1209 = {
			controlled_by = GER
		}
		1253 = {
			controlled_by = GER
		}
		1296 = {
			controlled_by = GER
		}
		1252 = {
			controlled_by = GER
		}
		1208 = {
			controlled_by = GER
		}
		1386 = {
			controlled_by = GER
		}
		1668 = {
			controlled_by = GER
		}
		1616 = {
			controlled_by = GER
		}
		1568 = {
			controlled_by = GER
		}
		1524 = {
			controlled_by = GER
		}
		1523 = {
			controlled_by = GER
		}
		1615 = {
			controlled_by = GER
		}
		1667 = {
			controlled_by = GER
		}
		1614 = {
			controlled_by = GER
		}
		1566 = {
			controlled_by = GER
		}
		1522 = {
			controlled_by = GER
		}
		1567 = {
			controlled_by = GER
		}
		1478 = {
			controlled_by = GER
		}
		1433 = {
			controlled_by = GER
		}
		1388 = {
			controlled_by = GER
		}
		1389 = {
			controlled_by = GER
		}
		1344 = {
			controlled_by = GER
		}
		1299 = {
			controlled_by = GER
		}
		1432 = {
			controlled_by = GER
		}
		1343 = {
			controlled_by = GER
		}
		1298 = {
			controlled_by = GER
		}
		1255 = {
			controlled_by = GER
		}
		1210 = {
			controlled_by = GER
		}
		1169 = {
			controlled_by = GER
		}
		1129 = {
			controlled_by = GER
		}
		1168 = {
			controlled_by = GER
		}
		1128 = {
			controlled_by = GER
		}
		1167 = {
			controlled_by = GER
		}
		1090 = {
			controlled_by = GER
		}
		1127 = {
			controlled_by = GER
		}
		1089 = {
			controlled_by = GER
		}
		1126 = {
			controlled_by = GER
		}
		1052 = {
			controlled_by = GER
		}
		1015 = {
			controlled_by = GER
		}
		973 = {
			controlled_by = GER
		}
		1014 = {
			controlled_by = GER
		}
		846 = {
			controlled_by = GER
		}
		722 = {
			controlled_by = GER
		}
		681 = {
			controlled_by = GER
		}
		724 = {
			controlled_by = GER
		}
		766 = {
			controlled_by = GER
		}
		807 = {
			controlled_by = GER
		}
		892 = {
			controlled_by = GER
		}
		932 = {
			controlled_by = GER
		}
		974 = {
			controlled_by = GER
		}
		933 = {
			controlled_by = GER
		}
		848 = {
			controlled_by = GER
		}
		975 = {
			controlled_by = GER
		}
		1016 = {
			controlled_by = GER
		}
		1053 = {
			controlled_by = GER
		}
		1017 = {
			controlled_by = GER
		}
		934 = {
			controlled_by = GER
		}
		894 = {
			controlled_by = GER
		}
		850 = {
			controlled_by = GER
		}
		849 = {
			controlled_by = GER
		}
		893 = {
			controlled_by = GER
		}
		976 = {
			controlled_by = GER
		}
		847 = {
			controlled_by = GER
		}
		765 = {
			controlled_by = GER
		}
		723 = {
			controlled_by = GER
		}
		680 = {
			controlled_by = GER
		}
		891 = {
			controlled_by = GER
		}
		604 = {
			controlled_by = GER
		}
		417 = {
			controlled_by = GER
		}
		806 = {
			controlled_by = GER
		}
		14153 = {
			controlled_by = GER
		}
		# No need for Northern Ireland in this -Marneman
		#1431 = { controlled_by = GER }
		#1385 = { controlled_by = GER }
		#1340 = { controlled_by = GER }
		#1384 = { controlled_by = GER }
		#1295 = { controlled_by = GER }
		#1341 = { controlled_by = GER }
		#1251 = { controlled_by = GER }
		# USA has to be at war with GER.
		war_with = GER
		# Player must have chosen scripted invasions
		has_global_flag = invasion_choice
		# Eastern USA must be intact
		# NOTE: Based on what I had to do with ENG above, these probably need to be changed as well ... :(
		washington_dc_region = {
			controlled_by = USA
		}
		mississippi_region = {
			controlled_by = USA
		}
		alabama_region = {
			controlled_by = USA
		}
		georgia_region = {
			controlled_by = USA
		}
		tennesse_region = {
			controlled_by = USA
		}
		kentucky_region = {
			controlled_by = USA
		}
		connecticut_region = {
			controlled_by = USA
		}
		new_york_region = {
			controlled_by = USA
		}
		new_jersey_region = {
			controlled_by = USA
		}
		west_virginia_region = {
			controlled_by = USA
		}
		virginia_region = {
			controlled_by = USA
		}
		north_carolina_region = {
			controlled_by = USA
		}
		south_carolina_region = {
			controlled_by = USA
		}
		florida_region = {
			controlled_by = USA
		}
		ohio_region = {
			controlled_by = USA
		}
		mariland_region = {
			controlled_by = USA
		}
		missouri_region = {
			controlled_by = USA
		}
		arkansas_region = {
			controlled_by = USA
		}
		louisiana_region = {
			controlled_by = USA
		}
		# Germany has to have invaded the USA, and the cooldown period from the invasion by GER of the USA should be over
		# NOTE: Since this is AI-only, and the "Germany Invades the USA" events are for the USA player, this will never be set!
		# So we won't bother with it for now.
		# has_global_flag = germany_invades_usa
		# USA = { NOT = { has_country_modifier = german_invasion_usa_cooldown } }
	}
	title = "Operation Britannia Rising"
	desc = "Operation Britannia Rising"
	picture = "blackice"
	mean_time_to_happen = {
		days = 1
	}
	option = {
		name = "Ok."
		set_global_flag = operation_britannia_rising
	}
}
################################################################################################
#
# Next, the USA/AI is presented with their options for where they will invade.
#
#################################################################################################
country_event = {
	id = 995001
	fire_only_once = yes
	#major = yes # Just for debugging
	# Triggers for the USA AI only
	trigger = {
		tag = USA
		ai = yes
		has_global_flag = operation_britannia_rising
	}
	title = "Liberate England"
	desc = "Liberate England"
	picture = "blackice"
	option = {
		name = "Invade via Scotland"
		set_global_flag = britannia_dest_chosen
		set_global_flag = britannia_dest_scotland
		ai_chance = {
			factor = 25
		}
	}
	option = {
		name = "Invade in the South of England"
		set_global_flag = britannia_dest_chosen
		set_global_flag = britannia_dest_south_england
		ai_chance = {
			factor = 25
		}
	}
	option = {
		name = "Invade in Central England"
		set_global_flag = britannia_dest_chosen
		set_global_flag = britannia_dest_central_england
		ai_chance = {
			factor = 25
		}
	}
	option = {
		name = "Invade via Multiple Points"
		set_global_flag = britannia_dest_chosen
		set_global_flag = britannia_dest_scattered
		ai_chance = {
			factor = 25
		}
	}
}
#################################################################################################
#
# The day has arrived!
#
#################################################################################################
country_event = {
	id = 995002
	fire_only_once = yes
	major = yes
	trigger = {
		# USA/AI Only
		tag = USA
		ai = yes
		has_global_flag = operation_britannia_rising
		has_global_flag = britannia_dest_chosen
		# TODO - check for end of a cooldown from when the USA/AI chose their path, to simulate buildup time
	}
	title = "Operation Britannia Rising Underway!"
	desc = "The forces of the United States have undertaken an operation to liberate England from German oppression."
	picture = "blackice"
	option = {
		name = "EVTOPTAMARNE995002"
		ai_chance = {
			factor = 100
		}
		set_global_flag = britannia_underway
		######################################################################################################
		# Scotland
		######################################################################################################
		Marnemans_Fake_Region = {
			limit = {
				has_global_flag = britannia_dest_scotland
			}
			847 = {
				change_controller = USA
			}
			847 = {
				change_owner = USA
			}
			THIS = {
				load_oob = MarneMod/MarneMod_Britannia_Scotland_OOB.txt
			}
		}
		######################################################################################################
		# Southern England
		######################################################################################################
		Marnemans_Fake_Region = {
			limit = {
				has_global_flag = britannia_dest_south_england
			}
			1726 = {
				change_controller = USA
			}
			1726 = {
				change_owner = USA
			}
			THIS = {
				load_oob = MarneMod/MarneMod_Britannia_Southern_England_OOB.txt
			}
		}
		######################################################################################################
		# Central England
		######################################################################################################
		Marnemans_Fake_Region = {
			limit = {
				has_global_flag = britannia_dest_central_england
			}
			1389 = {
				change_controller = USA
			}
			1389 = {
				change_owner = USA
			}
			THIS = {
				load_oob = MarneMod/MarneMod_Britannia_Central_England_OOB.txt
			}
		}
		######################################################################################################
		# Scattered
		######################################################################################################
		Marnemans_Fake_Region = {
			limit = {
				has_global_flag = britannia_dest_scattered
			}
			847 = {
				change_controller = USA
			}
			1726 = {
				change_controller = USA
			}
			847 = {
				change_owner = USA
			}
			1726 = {
				change_owner = USA
			}
			THIS = {
				load_oob = MarneMod/MarneMod_Britannia_Scattered_OOB.txt
			}
		}
	}
}
# Give the Allied landings some supplies, provided the Allies control the landing province!
country_event = {
	id = 995003
	#major = yes # Debugging only!
	fire_only_once = yes
	trigger = {
		# USA (if one of the invasion flags is set AND they control the appropriate landing province)
		# In theory, this is AI-only, since the flag will only be set for USA AI
		tag = USA
		ai = yes
		war_with = GER
		has_country_flag = britannia_dest_chosen
	}
	# Only pass through this filter if one of the invasion provinces is owned by USA
	# NOTE: We should probably adjust this so that it doesn't fire for the reinforcement wave.
	mean_time_to_happen = {
		days = 9999999
		modifier = {
			factor = 1

			not = {
				has_global_flag = britannia_underway
			}
		}
		modifier = {
			factor = 0.000000001
			847 = {
				controller = {
					faction = allies
				}
			}
		}
		modifier = {
			factor = 0.000000001
			1726 = {
				controller = {
					faction = allies
				}
			}
		}
		modifier = {
			factor = 0.000000001
			1389 = {
				controller = {
					faction = allies
				}
			}
		}
	}
	title = "Supplies and Fuel"
	desc = "Supplies and Fuel"
	picture = "blackice"
	option = {
		name = "Ok."
		1389 = {
			limit = {
				has_global_flag = britannia_dest_central_england
			}
			limit = {
				controller = {
					faction = allies
				}
			}
			supplies = 10000
			fuel = 10000
			naval_base = 10
		}
		847 = {
			limit = {
				has_global_flag = britannia_dest_scotland
			}
			limit = {
				controller = {
					faction = allies
				}
			}
			supplies = 10000
			fuel = 10000
			naval_base = 10
		}
		1726 = {
			limit = {
				has_global_flag = britannia_dest_south_england
			}
			limit = {
				controller = {
					faction = allies
				}
			}
			supplies = 10000
			fuel = 10000
			naval_base = 10
		}
		847 = {
			limit = {
				has_global_flag = britannia_dest_scattered
			}
			limit = {
				controller = {
					faction = allies
				}
			}
			supplies = 10000
			fuel = 10000
			naval_base = 10
		}
		1726 = {
			limit = {
				has_global_flag = britannia_dest_scattered
			}
			limit = {
				controller = {
					faction = allies
				}
			}
			supplies = 10000
			fuel = 10000
			naval_base = 10
		}
	}
}
# Liberation event!
# Commented out for now, because the fucking Mainland_England check in the trigger isn't working right ... -Marneman
# country_event = {
# id = 995004
# major = yes
# fire_only_once = yes
# trigger = {
# # USA (if one of the invasion flags is set AND they control the appropriate landing province)
# # In theory, this is AI-only, since the flag will only be set for USA AI
# tag = ENG
# war_with = GER
# has_global_flag = britannia_underway
# mainland_england = { controlled_by = ENG }
# }
# title = "Liberation is at hand!"
# desc = "England has been liberated by the Yanks!"
# picture = "blackice"
# option = {
# name = "Most excellent!"
# dissent = -25
# national_unity = 10
# }
# }
#################################################################################################
#
# End of Operation Britannia Rising
#
#################################################################################################